{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){return function(){var Super=_getPrototypeOf(Derived),result;if(_isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React,{Component}from'react';import{DrawerItems}from'react-navigation-drawer';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import{RFValue}from'react-native-responsive-fontsize';import firebase from'firebase';import{Avatar}from'react-native-elements';import*as ImagePicker from\"expo-image-picker\";var CustomSideBarMenu=function(_Component){_inherits(CustomSideBarMenu,_Component);var _super=_createSuper(CustomSideBarMenu);function CustomSideBarMenu(){var _this;_classCallCheck(this,CustomSideBarMenu);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={userID:firebase.auth().currentUser.email,image:'#',name:'',docID:''};_this.selectPicture=function _callee(){var _await$ImagePicker$la,cancelled,uri;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({mediaTypes:ImagePicker.MediaTypeOptions.All,allowsEditing:true,aspect:[4,3],quality:1}));case 2:_await$ImagePicker$la=_context.sent;cancelled=_await$ImagePicker$la.cancelled;uri=_await$ImagePicker$la.uri;if(!cancelled){_this.uploadImage(uri,_this.state.userID);_this.setState({image:uri});}case 6:case\"end\":return _context.stop();}}},null,null,null,Promise);};_this.uploadImage=function _callee2(uri,imageName){var response,blob,ref;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(fetch(uri));case 2:response=_context2.sent;_context2.next=5;return _regeneratorRuntime.awrap(response.blob());case 5:blob=_context2.sent;ref=firebase.storage().ref().child('user_profile/'+imageName);return _context2.abrupt(\"return\",ref.put(blob).then(function(response){_this.fetchImage(imageName);}));case 8:case\"end\":return _context2.stop();}}},null,null,null,Promise);};_this.fetchImage=function(imageName){var storageRef=firebase.storage().ref().child('user_profile/'+imageName);storageRef.getDownloadURL().then(function(URL){_this.setState({image:url});}).catch(function(error){_this.setState({image:'#'});});};return _this;}_createClass(CustomSideBarMenu,[{key:\"getUserProfile\",value:function getUserProfile(){var _this2=this;db.collection('User').where('emailID','==',this.state.user_id).onSnapshot(function(querySnapshot){querySnapshot.forEach(function(doc){_this2.setState({name:doc.data().first_name+''+doc.data().last_name});});});}},{key:\"componentDidMount\",value:function componentDidMount(){this.fetchName(this.state.userID);this.state.getUserProfile();}},{key:\"render\",value:function render(){var _this3=this;return React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{flex:0.5,alignItems:'center',backgroundColor:'orange'}},React.createElement(Avatar,{rounded:true,source:{uri:this.state.image},size:'xlarge',onPress:function onPress(){_this3.selectPicture();},containerStyle:styles.imageContainer,showEditButton:true}),React.createElement(Text,{style:{fontWeight:'100',fontSize:20,paddingTop:20}},this.state.name,\" \")),React.createElement(View,{style:styles.drawerItemsContainer},React.createElement(DrawerItems,this.props)),React.createElement(View,{style:styles.logoutContainer},React.createElement(TouchableOpacity,{style:styles.logoutButton,onPress:function onPress(){_this3.props.navigation.navigate('WelcomeScreen');firebase.auth().signOut();}},React.createElement(Icon,{name:\"logout\",type:\"antdesign\",size:RFValue(20),iconStyle:{paddingLeft:RFValue(10)}}),React.createElement(Text,{style:styles.logOutText},\"Logout\"))));}}]);return CustomSideBarMenu;}(Component);export{CustomSideBarMenu as default};var styles=StyleSheet.create({container:{flex:1},drawerItemsContainer:{flex:0.8,marginTop:50},logOutContainer:{flex:0.2,justifyContent:'flex-end',paddingBottom:100,marginLeft:50},logoutButton:{height:60,width:200,justifyContent:'center',alignItems:'center',marginLeft:40,borderWidth:1.5,borderRadius:50},logOutText:{fontSize:RFValue(15),fontWeight:'bold',marginLeft:RFValue(30)}});","map":{"version":3,"sources":["C:/Users/aines/Desktop/book-santa-stage-11-master/components/CustomSideBarMenu.js"],"names":["React","Component","DrawerItems","RFValue","firebase","Avatar","ImagePicker","CustomSideBarMenu","state","userID","auth","currentUser","email","image","name","docID","selectPicture","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","allowsEditing","aspect","quality","cancelled","uri","uploadImage","setState","imageName","fetch","response","blob","ref","storage","child","put","then","fetchImage","storageRef","getDownloadURL","URL","url","catch","error","db","collection","where","user_id","onSnapshot","querySnapshot","forEach","doc","data","first_name","last_name","fetchName","getUserProfile","flex","alignItems","backgroundColor","styles","imageContainer","fontWeight","fontSize","paddingTop","drawerItemsContainer","props","logoutContainer","logoutButton","navigation","navigate","signOut","paddingLeft","logOutText","StyleSheet","create","container","marginTop","logOutContainer","justifyContent","paddingBottom","marginLeft","height","width","borderWidth","borderRadius"],"mappings":"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","sourcesContent":["import React,{Component} from 'react';\r\nimport {DrawerItems } from 'react-navigation-drawer'\r\nimport {View,Text,StyleSheet,TouchableOpacity} from 'react-native';\r\nimport {RFValue} from 'react-native-responsive-fontsize';\r\nimport firebase from 'firebase';\r\nimport {Avatar} from 'react-native-elements';\r\nimport * as ImagePicker from \"expo-image-picker\";\r\nexport default class CustomSideBarMenu extends Component{\r\n    state={\r\n        userID:firebase.auth().currentUser.email,\r\n        image:'#',\r\n        name:'',\r\n        docID:'',\r\n    }\r\n    selectPicture = async ()=>{\r\n          const{cancelled,uri}=await ImagePicker.launchImageLibraryAsync({\r\n            mediaTypes: ImagePicker.MediaTypeOptions.All,\r\n            allowsEditing: true,\r\n            aspect: [4, 3],\r\n            quality: 1,\r\n          })\r\n          if(!cancelled){\r\n              this.uploadImage(uri,this.state.userID);\r\n              this.setState({\r\n                  image:uri\r\n              })\r\n          }\r\n    }\r\n\r\n    uploadImage = async(uri,imageName)=>{\r\n    var response = await fetch(uri);\r\n    var blob = await response.blob();\r\n    var ref = firebase\r\n    .storage()\r\n    .ref()\r\n    .child('user_profile/' + imageName);\r\n    \r\n            return ref.put(blob).then( (response) => {\r\n                    this.fetchImage(imageName);\r\n                });\r\n    \r\n    }\r\n\r\n    fetchImage= (imageName)=>{\r\n        var storageRef = firebase\r\n        .storage()\r\n        .ref()\r\n        .child('user_profile/'+ imageName);\r\n\r\n            storageRef\r\n            .getDownloadURL()\r\n            .then((URL)=>{\r\n                this.setState({ image:url })\r\n            })\r\n            .catch((error)=>{\r\n                this.setState({image:'#'})\r\n            })\r\n    }\r\n    getUserProfile(){\r\n        db.collection('User').where('emailID','==', this.state.user_id)\r\n        .onSnapshot((querySnapshot)=>{\r\n            querySnapshot.forEach((doc)=>{\r\n                this.setState({name:doc.data().first_name+''+doc.data().last_name})\r\n            })\r\n        })\r\n    }\r\n    componentDidMount(){\r\n        this.fetchName(this.state.userID);\r\n        this.state.getUserProfile();\r\n    }\r\n    render(){\r\n        return(\r\n            <View style={{flex:1}}>\r\n                <View style={{flex:0.5,alignItems:'center',backgroundColor:'orange'}}>\r\n                    <Avatar rounded source={{\r\n                        uri:this.state.image\r\n                    }} \r\n                    size={'xlarge'} \r\n                    onPress={()=>{ this.selectPicture() }} \r\n                    containerStyle={styles.imageContainer}\r\n                    showEditButton/>\r\n                    <Text style={{fontWeight:'100',fontSize:20,paddingTop:20 }}>{this.state.name} </Text>\r\n                </View>\r\n                <View style={styles.drawerItemsContainer}>\r\n                    <DrawerItems {...this.props}/>\r\n                </View>\r\n               <View style={styles.logoutContainer}>\r\n                   <TouchableOpacity style={styles.logoutButton}\r\n                                     onPress={()=>{\r\n                                         this.props.navigation.navigate('WelcomeScreen')\r\n                                         firebase.auth().signOut()\r\n                    }}>\r\n                            <Icon name='logout' type='antdesign' size={RFValue(20)} iconStyle={{paddingLeft:RFValue(10)}} />\r\n                            <Text style={styles.logOutText}>Logout</Text>\r\n                  </TouchableOpacity>\r\n                   </View> \r\n            </View>\r\n        )\r\n    }\r\n}\r\nvar styles = StyleSheet.create({ \r\n    container : { flex:1 },\r\n     drawerItemsContainer:{ flex:0.8,  marginTop:50 },\r\n      logOutContainer : { flex:0.2,\r\n         justifyContent:'flex-end',\r\n          paddingBottom:100,\r\n          marginLeft:50,\r\n         },\r\n           logoutButton : { \r\n               height:60,\r\n              width:200,\r\n              justifyContent:'center',\r\n              alignItems:'center', \r\n              marginLeft:40,\r\n              borderWidth:1.5,\r\n              borderRadius:50,\r\n              \r\n            },\r\n               logOutText:{ fontSize: RFValue(15),\r\n                 fontWeight:'bold',\r\n                 marginLeft:RFValue(30) \r\n                } \r\n            })\r\n"]},"metadata":{},"sourceType":"module"}