{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){return function(){var Super=_getPrototypeOf(Derived),result;if(_isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React,{Component}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TextInput from\"react-native-web/dist/exports/TextInput\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Alert from\"react-native-web/dist/exports/Alert\";import Modal from\"react-native-web/dist/exports/Modal\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import{GoogleBookSearch}from'react-native-google-books';import{RFValue}from'react-native-responsive-fontsize';import firebase from'firebase';import db from\"../config\";import MyHeader from\"../components/MyHeader\";import BookSearch from'react-native-google-books/BookSearch';import{FlatList}from'react-native-gesture-handler';var BookRequestScreen=function(_Component){_inherits(BookRequestScreen,_Component);var _super=_createSuper(BookRequestScreen);function BookRequestScreen(){var _this;_classCallCheck(this,BookRequestScreen);_this=_super.call(this);_this.addRequest=function _callee(BookName,ReasonForRequest){var userID,randomRequestID,books;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:userID=_this.state.userID;randomRequestID=_this.createUniqueId();_context.next=4;return _regeneratorRuntime.awrap(BookSearch.searchbook(bookName,'AIzaSyAV6CZ9luleYpvAKf5lmeVN6TYnhEhz3OU'));case 4:books=_context.sent;db.collection('requested_books').add({\"user_id\":userID,\"book_name\":BookName,\"reason_to_request\":ReasonForRequest,\"request_id\":randomRequestID,\"book_status\":'requested',\"date\":firebase.firestore.FieldValue.serverTimestamp(),\"image_link\":books.data[0].volumeInfo.imageLinks.smallThumbnail});_context.next=8;return _regeneratorRuntime.awrap(_this.getBookRequest());case 8:db.collection('User').where('email_id','==','user_id').get().then().then(function(snapshot){snapshot.forEach(function(doc){db.collection('User').doc(doc.id).update({is_book_request_active:true});});});_this.setState({bookName:'',ReasonForRequest:'',requestID:''});return _context.abrupt(\"return\",Alert.alert(\"Book Requested Successfully\"));case 11:case\"end\":return _context.stop();}}},null,null,null,Promise);};_this.getBookRequest=function(){var bookRequest=db.collection('requested_books').where('user_id','==',_this.state.userId).get().then(function(snapshot){snapshot.forEach(function(doc){if(doc.data().book_status!=='received'){_this.setState({requestID:doc.data().request_id,requestedBookName:doc.data().book_name,book_status:doc.data().book_status,doc_id:doc.id});}});});};_this.renderItem=function(_ref){var item=_ref.item,i=_ref.i;return React.createElement(TouchableHighlight,{style:{alignItems:\"center\",backgroundColor:\"#DDDDDD\",padding:10,width:'90%'},activeOpacity:0.6,underlayColor:\"#DDDDDD\",onPress:function onPress(){_this.setState({showFlatlist:false,bookName:item.volumeInfo.title});},bottomDivider:true},React.createElement(Text,null,item.volumeInfo.title));};_this.state={userId:firebase.auth().currentUser.email,BookName:\"\",ReasonForRequest:\"\",is_book_request_active:\"\",requestedBookName:\"\",book_status:\"\",requestID:\"\",userDocID:'',doc_id:'',image_link:'',dataSource:\"\",showFlatlist:false};return _this;}_createClass(BookRequestScreen,[{key:\"createUniqueId\",value:function createUniqueId(){return Math.random().toString(36).substring(7);}},{key:\"getIsBookRequestActive\",value:function getIsBookRequestActive(){var _this2=this;db.collection('User').where('email_id','==',this.state.userID).onSnapshot(function(querySnapshot){querySnapshot.forEach(function(doc){_this2.setState({is_book_request_active:doc.data().is_book_request_active,userDocId:doc.id});});});}},{key:\"getBooksFromAPI\",value:function getBooksFromAPI(BookName){var books;return _regeneratorRuntime.async(function getBooksFromAPI$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.setState({BookName:book_name});if(!(BookName.length>2)){_context2.next=6;break;}_context2.next=4;return _regeneratorRuntime.awrap(BookSearch.searchbook(BookName,'AIzaSyAV6CZ9luleYpvAKf5lmeVN6TYnhEhz3OU'));case 4:books=_context2.sent;this.setState({datasource:books.data,showFlatList:true});case 6:case\"end\":return _context2.stop();}}},null,this,null,Promise);}},{key:\"componentDidMount\",value:function componentDidMount(){this.getBookRequest(),this.getIsBookRequestActive();}},{key:\"render\",value:function render(){var _this3=this;if(this.state.is_book_request_active==='true'){return React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(View,{style:{borderColor:\"orange\",borderWidth:2,justifyContent:'center',alignItems:'center',padding:10,margin:10}},React.createElement(Text,null,\"Book Name\"),React.createElement(Text,null,this.state.requestedBookName)),React.createElement(View,{style:{borderColor:\"orange\",borderWidth:2,justifyContent:'center',alignItems:'center',padding:10,margin:10}},React.createElement(Text,null,\" Book Status \"),React.createElement(Text,null,this.state.bookStatus)));}else{return React.createElement(View,{style:{flex:1}},React.createElement(MyHeader,{title:\"Request Book\",navigation:this.props.navigation}),React.createElement(KeyboardAvoidingView,{style:styles.keyBoardStyle},React.createElement(View,null,React.createElement(TextInput,{style:styles.formTextInput,label:bookName,placeholder:\"Enter Book Name\",onChangeText:function onChangeText(text){_this3.setState({BookName:text});},value:this.state.BookName}),this.state.showFlatList?React.createElement(FlatList,{data:this.state.dataSource,renderItem:this.renderItem,enableEmptySections:true,style:{marginTop:10},keyExtractor:function keyExtractor(item,index){return index.toString();}}):React.createElement(View,{style:{alignItems:'center'}},React.createElement(TextInput,{style:[styles.formTextInput,{height:300}],multiline:true,numberOfLines:8,label:reason,placeholder:\"Why do you need the book\",onChangeText:function onChangeText(text){_this3.setState({ReasonForRequest:text});},value:this.state.ReasonForRequest}),React.createElement(TouchableOpacity,{style:styles.button,onPress:function onPress(){_this3.addRequest(_this3.state.BookName,_this3.state.ReasonForRequest);}},React.createElement(Text,null,\"Request\"))))));}}}]);return BookRequestScreen;}(Component);export{BookRequestScreen as default};var styles=StyleSheet.create({keyBoardStyle:{width:300,height:50,alignItems:'center',justifyContent:'center',borderRadius:15,margin:10,padding:10},formTextInput:{justifyContent:'center',alignItems:'center',marginTop:190,marginLeft:80,padding:10,width:150,height:50},button:{marginTop:50,marginLeft:90,height:50,width:100,alignItems:'center',justifyContent:'center',borderRadius:5,backgroundColor:'orange'}});","map":{"version":3,"sources":["C:/Users/aines/Desktop/book-santa-stage-11-master/screens/BookRequestScreen.js"],"names":["React","Component","GoogleBookSearch","RFValue","firebase","db","MyHeader","BookSearch","FlatList","BookRequestScreen","addRequest","BookName","ReasonForRequest","userID","state","randomRequestID","createUniqueId","searchbook","bookName","books","collection","add","firestore","FieldValue","serverTimestamp","data","volumeInfo","imageLinks","smallThumbnail","getBookRequest","where","get","then","snapshot","forEach","doc","id","update","is_book_request_active","setState","requestID","Alert","alert","bookRequest","userId","book_status","request_id","requestedBookName","book_name","doc_id","renderItem","item","i","alignItems","backgroundColor","padding","width","showFlatlist","title","auth","currentUser","email","userDocID","image_link","dataSource","Math","random","toString","substring","onSnapshot","querySnapshot","userDocId","length","datasource","showFlatList","getIsBookRequestActive","flex","justifyContent","borderColor","borderWidth","margin","bookStatus","props","navigation","styles","keyBoardStyle","formTextInput","text","marginTop","index","height","reason","button","StyleSheet","create","borderRadius","marginLeft"],"mappings":"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","sourcesContent":["import  React, {Component} from 'react';\r\nimport {View,Text,TextInput,StyleSheet,TouchableOpacity, Alert,Modal,KeyboardAvoidingView,ScrollView,TouchableHighlight} from 'react-native';\r\nimport {GoogleBookSearch} from 'react-native-google-books';\r\nimport {RFValue} from 'react-native-responsive-fontsize';\r\nimport firebase from 'firebase';\r\nimport db from '../config';\r\nimport MyHeader from '../components/MyHeader';\r\nimport BookSearch from 'react-native-google-books/BookSearch';\r\nimport { FlatList } from 'react-native-gesture-handler';\r\nexport default class BookRequestScreen extends Component{\r\n    constructor(){\r\n        super();\r\n        this.state ={ userId : firebase.auth().currentUser.email, \r\n          BookName:\"\", \r\n          ReasonForRequest:\"\", \r\n          is_book_request_active : \"\", \r\n          requestedBookName: \"\", \r\n          book_status:\"\", \r\n          requestID:\"\", \r\n          userDocID: '', \r\n          doc_id :'', \r\n          image_link: '', \r\n          dataSource:\"\", \r\n          showFlatlist: false \r\n        } }\r\n      \r\n    \r\n      createUniqueId(){\r\n        return Math.random().toString(36).substring(7);\r\n      }\r\n      addRequest= async (BookName,ReasonForRequest)=>{\r\n        var userID = this.state.userID\r\n        var randomRequestID = this.createUniqueId()\r\n        var books=await BookSearch.searchbook(bookName,'AIzaSyAV6CZ9luleYpvAKf5lmeVN6TYnhEhz3OU')\r\n        db.collection('requested_books').add({\r\n            \"user_id\": userID,\r\n            \"book_name\":BookName,\r\n            \"reason_to_request\":ReasonForRequest,\r\n            \"request_id\"  : randomRequestID,\r\n            \"book_status\":'requested',\r\n            \"date\":firebase.firestore.FieldValue.serverTimestamp(),\r\n            \"image_link\": books.data[0].volumeInfo.imageLinks.smallThumbnail\r\n    \r\n    })\r\n      \r\n\r\n    await this.getBookRequest()\r\n    db.collection('User').where('email_id','==','user_id').get()\r\n    .then()\r\n    .then((snapshot)=>{\r\n      snapshot.forEach((doc)=>{\r\n        db.collection('User').doc(doc.id).update({\r\n          is_book_request_active:true\r\n        })\r\n      })\r\n    })\r\n    this.setState({\r\n      bookName:'',\r\n      ReasonForRequest:'',\r\n      requestID:'',\r\n\r\n    })\r\n    return Alert.alert(\"Book Requested Successfully\") \r\n  } \r\n\r\n getIsBookRequestActive(){\r\n    db.collection('User') \r\n    .where('email_id','==',this.state.userID) \r\n    .onSnapshot(querySnapshot => { querySnapshot.forEach(doc => {\r\n       this.setState({ \r\n         is_book_request_active:doc.data().is_book_request_active, \r\n         userDocId : doc.id \r\n        })\r\n       })\r\n       }) }\r\n  \r\n\r\ngetBookRequest=()=>{\r\n  var bookRequest=db.collection('requested_books').where('user_id','==',this.state.userId)\r\n  .get()\r\n  .then((snapshot)=>{\r\n    snapshot.forEach((doc)=>{\r\n  if(doc.data().book_status!=='received'){\r\n    this.setState({\r\n      requestID:doc.data().request_id,\r\n      requestedBookName:doc.data().book_name,\r\n      book_status:doc.data().book_status,\r\n      doc_id:doc.id\r\n    })\r\n  }\r\n    })\r\n  })\r\n}\r\n\r\nasync getBooksFromAPI(BookName){\r\nthis.setState({\r\n  BookName:book_name,\r\n})\r\nif(BookName.length>2){\r\n  var books= await BookSearch.searchbook(BookName,'AIzaSyAV6CZ9luleYpvAKf5lmeVN6TYnhEhz3OU')\r\n  this.setState({datasource:books.data,\r\n                showFlatList:true})\r\n}\r\n}\r\ncomponentDidMount(){\r\n  this.getBookRequest(),\r\n  this.getIsBookRequestActive()\r\n}\r\nrenderItem=({item,i})=>{\r\n  return(\r\n    <TouchableHighlight style={{ alignItems: \"center\", backgroundColor: \"#DDDDDD\", \r\n    padding: 10, width: '90%', }} \r\n    activeOpacity={0.6} underlayColor=\"#DDDDDD\" \r\n    onPress={()=>{\r\n       this.setState({\r\n          showFlatlist:false,\r\n           bookName:item.volumeInfo.title, \r\n           })} }\r\n            bottomDivider>\r\n      <Text>{item.volumeInfo.title}</Text>\r\n    </TouchableHighlight>\r\n  )\r\n}\r\n    render(){\r\n      if(this.state.is_book_request_active==='true'){\r\n        return(\r\n<View style = {{flex:1,justifyContent:'center'}}> \r\n<View style={{borderColor:\"orange\",borderWidth:2,justifyContent:'center',\r\nalignItems:'center',padding:10,margin:10}}> \r\n<Text>Book Name</Text> \r\n<Text>{this.state.requestedBookName}</Text> \r\n</View> \r\n<View style={{borderColor:\"orange\",borderWidth:2,justifyContent:'center',\r\nalignItems:'center',padding:10,margin:10}}> \r\n<Text> Book Status </Text> \r\n<Text>{this.state.bookStatus}</Text> \r\n</View>\r\n  </View> ) }\r\n        \r\n      else{\r\n    \r\n        return(\r\n          <View style={{flex:1}}>\r\n          <MyHeader title=\"Request Book\" navigation ={this.props.navigation}/>\r\n            <KeyboardAvoidingView style={styles.keyBoardStyle}>\r\n              <View>\r\n              <TextInput\r\n                style ={styles.formTextInput}\r\n                label={bookName}\r\n                placeholder={\"Enter Book Name\"}\r\n                onChangeText={(text)=>{\r\n                    this.setState({\r\n                        BookName:text\r\n                    })\r\n                }}\r\n                value={this.state.BookName}\r\n              />\r\n              {this.state.showFlatList ?\r\n              (<FlatList data={this.state.dataSource} \r\n                renderItem={this.renderItem} \r\n                enableEmptySections={true} \r\n                style={{ marginTop: 10 }} \r\n                keyExtractor={(item, index) => index.toString()}/>)\r\n               :(\r\n               \r\n              \r\n                 <View style={{alignItems:'center'}}>\r\n              <TextInput\r\n                style ={[styles.formTextInput,{height:300}]}\r\n                multiline\r\n                numberOfLines ={8}\r\n                label={reason}\r\n                placeholder={\"Why do you need the book\"}\r\n                onChangeText ={(text)=>{\r\n                    this.setState({\r\n                        ReasonForRequest:text\r\n                    })\r\n                }}\r\n                value ={this.state.ReasonForRequest}\r\n              />\r\n              <TouchableOpacity\r\n                style={styles.button}\r\n                onPress={()=>{this.addRequest(this.state.BookName,this.state.ReasonForRequest)}}\r\n                >\r\n                <Text>Request</Text>\r\n              </TouchableOpacity>\r\n              </View>\r\n               )\r\n              }\r\n              </View>\r\n            </KeyboardAvoidingView>\r\n        </View>\r\n        )\r\n              }\r\n              \r\n    }\r\n} \r\nconst styles = StyleSheet.create({\r\nkeyBoardStyle:{\r\n  width:300,\r\n  height:50,\r\n  alignItems:'center',\r\n  justifyContent:'center',\r\n  borderRadius:15,\r\n  margin:10,\r\n  padding:10,\r\n},\r\nformTextInput:{\r\n  justifyContent:'center',\r\n  alignItems:'center',\r\n  marginTop:190,\r\n  marginLeft:80,\r\n  padding:10,\r\n  width:150,\r\n  height:50,\r\n},\r\nbutton:{\r\n  marginTop:50,\r\n  marginLeft:90,\r\n  height:50,\r\n  width:100,\r\n  alignItems:'center',\r\n  justifyContent:'center',\r\n  borderRadius:5,\r\n  backgroundColor:'orange',\r\n}\r\n})"]},"metadata":{},"sourceType":"module"}